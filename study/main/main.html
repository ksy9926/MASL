<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="layout.css">
    <title>MASL | Main</title>
</head>

<body>
    <div id="map"></div>
    <script type="text/javascript"
        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=10006c6206025d0a4da93230b38d2bd2"></script>
    <script>
        // 로컬에서 실행 시 - cmd 에서 현재 폴더로 이동 -> python -m http.server 8080 실행 -> 크롬 브라우저에 http://localhost:8080
        
        var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
            mapOption = {
                center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 Default 중심좌표
                level: 5 // 지도의 확대 레벨 
            };

        var map = new kakao.maps.Map(mapContainer, mapOption); // 지도 생성

        // HTML5의 geolocation으로 사용할 수 있는지 확인
        if (navigator.geolocation) {

            // GeoLocation으로 접속 위치 가져오기
            navigator.geolocation.getCurrentPosition(function (position) {

                var lat = position.coords.latitude, // 위도
                    lon = position.coords.longitude; // 경도

                var locPosition = new kakao.maps.LatLng(lat, lon); // 마커가 표시될 위치를 얻어온 좌표로 생성

                // 마커 표시
                displayMarker(locPosition);

            });

        } else { // HTML5의 GeoLocation을 사용할 수 없을 때

            var locPosition = new kakao.maps.LatLng(33.450701, 126.570667);

            displayMarker(locPosition);
        }

        // 지도에 마커 표시하는 함수
        function displayMarker(locPosition) {

            // 마커를 생성
            var imageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png', // 마커이미지의 주소
            imageSize = new kakao.maps.Size(64, 69), // 마커이미지의 크기입니다
            imageOption = {offset: new kakao.maps.Point(27, 69)}; // 마커이미지의 옵션 - 마커의 좌표와 일치시킬 이미지 안에서의 좌표를 설정
      
            // 마커의 이미지 정보를 가지고 있는 마커 이미지 생성
            var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption);

            // 마커 생성
            var marker = new kakao.maps.Marker({
                position: locPosition, 
                image: markerImage // 마커이미지 설정 
            });

            // 지도 중심좌표를 접속위치로 변경
            map.setCenter(locPosition);

            // 마커가 지도 위에 표시되도록 설정
            marker.setMap(map);  
        }
        function panTo (moveLat, moveLon) {
            // 이동할 위도 경도 위치를 생성 - 원하는 행정동의 좌표로 이동하는 등.. 사용자 요청에 따른 좌표 필요
            var moveLocation = new kakao.maps.LatLng(moveLat, moveLon);
    
            // 지도 중심을 부드럽게 이동
            // 이동할 거리가 지도 화면보다 크면 이펙트 없이 이동
            map.panTo(moveLocation);            
        }
    </script>
</body>

</html>
